(()=>{"use strict";const e=()=>{"1"===localStorage.getItem("code")?localStorage.setItem("code","2"):"2"===localStorage.getItem("code")?localStorage.setItem("code","1"):"3"===localStorage.getItem("code")?localStorage.setItem("code","4"):"4"===localStorage.getItem("code")?localStorage.setItem("code","3"):"5"===localStorage.getItem("code")?localStorage.setItem("code","6"):"6"===localStorage.getItem("code")?localStorage.setItem("code","5"):"7"===localStorage.getItem("code")?localStorage.setItem("code","8"):"8"===localStorage.getItem("code")&&localStorage.setItem("code","7")},t=()=>{"1"===localStorage.getItem("code")?localStorage.setItem("code","5"):"2"===localStorage.getItem("code")?localStorage.setItem("code","6"):"3"===localStorage.getItem("code")?localStorage.setItem("code","7"):"4"===localStorage.getItem("code")?localStorage.setItem("code","8"):"5"===localStorage.getItem("code")?localStorage.setItem("code","1"):"6"===localStorage.getItem("code")?localStorage.setItem("code","2"):"7"===localStorage.getItem("code")?localStorage.setItem("code","3"):"8"===localStorage.getItem("code")&&localStorage.setItem("code","4")},o=(e,t,o)=>{let a="";a="ArrowUp"===o?"▲":"ArrowDown"===o||"ArrowDown"===o?"▼":"ArrowLeft"===o?"◄":"ArrowRight"===o?"►":o;const l=e.value.slice(0,e.selectionStart),c=e.value.slice(e.selectionStart),r=""+a;e.value=`${l+r+c}`,t.start++,t.end++,e.selectionStart=t.start,e.selectionEnd=t.end},a=(e,t)=>{if(e.selectionStart===e.selectionEnd){const o=e.value.slice(0,e.selectionStart),a=e.value.slice(e.selectionStart+1);e.value=`${o+a}`,e.selectionStart=t.start,e.selectionEnd=t.end}},l=(e,t)=>{let o="",a="";if(e.selectionStart!==e.selectionEnd){const l=e.selectionEnd-e.selectionStart;o=e.value.slice(0,e.selectionStart),a=e.value.slice(e.selectionEnd),t.end=t.end-l}else o=e.value.slice(0,e.selectionStart-1),a=e.value.slice(e.selectionStart),t.start=e.selectionStart-1,t.end=e.selectionEnd-1;e.value=`${o+a}`,e.selectionStart=t.start,e.selectionEnd=t.end},c=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","MetaLeft","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"],r={1:["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\","Del","Caps Lock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter","Shift","я","ч","с","м","и","т","ь","б","ю",".","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],2:["Ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","\\","Del","Caps Lock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","Enter","Shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",".","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],3:["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Del","Caps Lock","a","s","d","f","g","h","j","k","l",";","'","Enter","Shift","z","x","c","v","b","n","m",",",".","/","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],4:["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","Q","W","E","R","T","Y","U","I","O","P","[","]","\\","Del","Caps Lock","A","S","D","F","G","H","J","K","L",";","'","Enter","Shift","Z","X","C","V","B","N","M",",",".","/","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],5:["Ё","!",'"',"№",";","%",":","?","*","(",")","_","+","Backspace","Tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","/","Del","Caps Lock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","Enter","Shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",",","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],6:["ё","!",'"',"№",";","%",":","?","*","(",")","_","+","Backspace","Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","/","Del","Caps Lock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter","Shift","я","ч","с","м","и","т","ь","б","ю",",","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],7:["~","!","@","#","$","%","^","&","*","(",")","_","+","Backspace","Tab","Q","W","E","R","T","Y","U","I","O","P","{","}","|","Del","Caps Lock","A","S","D","F","G","H","J","K","L",":",'"',"Enter","Shift","Z","X","C","V","B","N","M","<",">","?","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],8:["~","!","@","#","$","%","^","&","*","(",")","_","+","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","{","}","|","Del","Caps Lock","a","s","d","f","g","h","j","k","l",":","'","Enter","Shift","z","x","c","v","b","n","m","<",">","?","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"]};document.querySelector("body").append((()=>{const s=document.createElement("div"),n=document.createElement("h1"),d=document.createElement("textarea"),i=document.createElement("div"),g=document.createElement("p"),S=document.createElement("p");d.setAttribute("cols",50),d.setAttribute("rows",5),n.innerHTML="Виртуальная клавиатура",g.innerHTML="Клавиатура создана в операционной системе Windows",S.innerHTML="Для переключения раскладки: левые Ctrl + Alt",i.classList.add("keyboard");const m=e=>{let t,o=e||null;i.innerHTML="",localStorage.getItem("code")?t=r[localStorage.getItem("code")]:(t=r[1],localStorage.setItem("code","1"));for(let e=0;e<t.length;e++){if(0===e||14===e||29===e||42===e||55===e){const e=document.createElement("div");e.classList.add("keyboard__row"),i.append(e)}const o=i.querySelectorAll(".keyboard__row"),a=document.createElement("div");a.classList.add("keyboard__button"),a.setAttribute("id",`${c[e]}`),t!=r[2]&&t!=r[4]&&t!=r[6]&&t!=r[8]||"CapsLock"===a.getAttribute("id")&&a.classList.add("pressed");const l=document.createElement("span");a.append(l);const s="Space"==`${t[e]}`?"":`${t[e]}`;l.innerHTML=s,o[o.length-1].append(a),t[e].length>1&&a.classList.add(`keyboard__button_${t[e].toLowerCase().replace(" ","-")}`),"▲"!==t[e]&&"◄"!==t[e]&&"▼"!==t[e]&&"►"!==t[e]||a.classList.add("keyboard__button_controls")}o&&i.querySelector(`#${o}`).classList.add("pressed")};m();let p={start:0,end:0},u=new Set;return d.addEventListener("focus",(()=>{d.selectionStart=p.start,d.selectionEnd=p.end})),s.addEventListener("click",(t=>{if(t.target.closest("textarea")&&(p.start=d.selectionStart,p.end=d.selectionEnd),t.target.closest(".keyboard__button_caps-lock")&&(e(),m()),t.target.closest(".keyboard__button_enter"))o(d,p,"\n");else if(t.target.closest(".keyboard__button_backspace"))l(d,p);else if(t.target.closest(".keyboard__button_tab"))o(d,p,"\t");else if(t.target.closest(".keyboard__button_del"))a(d,p);else if(t.target.closest(".keyboard__button_space"))o(d,p," ");else{if(!t.target.closest(".keyboard__button"))return;if("Caps Lock"===t.target.textContent||"Shift"===t.target.textContent||"Ctrl"===t.target.textContent||"Alt"===t.target.textContent||"Win"===t.target.textContent)return;o(d,p,t.target.textContent)}})),s.addEventListener("mousedown",(e=>{if(e.target.closest(".keyboard__button_shift")){const o=e.target.closest(".keyboard__button_shift").getAttribute("id");t(),m(o)}else e.target.closest(".keyboard__button")&&(e.target.closest(".keyboard__button").classList.add("pressed"),e.preventDefault())})),s.addEventListener("mouseup",(e=>{e.target.closest(".keyboard__button")&&e.target.closest(".keyboard__button").classList.remove("pressed"),e.target.closest(".keyboard__button_shift")&&(t(),m())})),document.addEventListener("keydown",(c=>{const r=i.querySelector(`#${c.code}`);if(r&&r.classList.add("pressed"),c.preventDefault(),"ControlLeft"===c.code||"AltLeft"===c.code){u.add(c.code);const e=["ControlLeft","AltLeft"];for(let t of e)if(!u.has(t))return;u.clear(),"1"===localStorage.getItem("code")?localStorage.setItem("code","3"):"2"===localStorage.getItem("code")?localStorage.setItem("code","4"):"3"===localStorage.getItem("code")?localStorage.setItem("code","1"):"4"===localStorage.getItem("code")?localStorage.setItem("code","2"):"5"===localStorage.getItem("code")?localStorage.setItem("code","7"):"6"===localStorage.getItem("code")?localStorage.setItem("code","8"):"7"===localStorage.getItem("code")?localStorage.setItem("code","5"):"8"===localStorage.getItem("code")&&localStorage.setItem("code","6"),m()}if("Shift"!==c.key||c.repeat||(t(),m(c.code)),"CapsLock"!==c.code||c.repeat||(e(),m()),"Enter"===c.key)o(d,p,"\n");else if("Backspace"===c.key)l(d,p);else if("Delete"===c.key)a(d,p);else if("Tab"===c.key)o(d,p,"\t");else if("Space"===c.code)o(d,p," ");else if("Meta"===c.key)console.log(c.key),setTimeout((()=>{r.classList.remove("pressed")}),500);else{if("CapsLock"===c.key||"Shift"===c.key||"Control"===c.key||"Alt"===c.key)return;const e=r?r.textContent:"";o(d,p,e)}})),document.addEventListener("keyup",(e=>{const o=i.querySelector(`#${e.code}`);"CapsLock"!==e.code&&o&&o.classList.remove("pressed"),u.delete(e.code),"Shift"===e.key&&(t(),m())})),s.classList.add("wrapper"),s.append(n),s.append(d),s.append(i),s.append(g),s.append(S),s})())})();